==> Creating result directory ...
==> Loading test settings ...
==> Deciding torch device ...
==> torch device:  cuda
==> Seeding everything ...
==> Building dynamical system ...
==> Building dynamics neural network ...
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
FullyConnectedNetwork                    [1, 3]                    --
├─Sequential: 1-1                        [1, 3]                    --
│    └─LinearLayer: 2-1                  [1, 16]                   64
│    └─LinearLayer: 2-2                  [1, 16]                   272
│    └─LinearLayer: 2-3                  [1, 3]                    51
├─Sequential: 1-2                        [1, 3]                    (recursive)
│    └─LinearLayer: 2-4                  [1, 16]                   (recursive)
│    └─LinearLayer: 2-5                  [1, 16]                   (recursive)
│    └─LinearLayer: 2-6                  [1, 3]                    (recursive)
==========================================================================================
Total params: 387
Trainable params: 387
Non-trainable params: 0
Total mult-adds (M): 0.00
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 0.00
Estimated Total Size (MB): 0.00
==========================================================================================
==> Training dynamics neural network ...
==> Plot drift errors (before training)
> (x1, x2): mean = 0.1504, max = 0.3993
> (x1, x3): mean = 0.1471, max = 0.3850
> (x2, x3): mean = 0.1365, max = 0.3109
==> Plot actuation errors (before training)
> (x1, x2): mean = 0.2990, max = 0.2990
> (x1, x3): mean = 0.2990, max = 0.2990
> (x2, x3): mean = 0.2990, max = 0.2990
==> Train dynamics
Dataset size: 47600
Epoch: 001 | Train Loss: 3.3705E-02 | Drift GN: 5.9260E-02 | Actu. GN: 1.5593E-01 | Time: 565ms
> Save model at epoch 001 with loss 3.3705E-02
> Save model at epoch 002 with loss 1.8838E-02
> Save model at epoch 003 with loss 4.8613E-03
> Save model at epoch 004 with loss 2.8326E-03
> Save model at epoch 005 with loss 2.4796E-03
Epoch: 006 | Train Loss: 2.3235E-03 | Drift GN: 1.9492E-03 | Actu. GN: 1.9635E-03 | Time: 447ms
> Save model at epoch 006 with loss 2.3235E-03
> Save model at epoch 007 with loss 2.2569E-03
> Save model at epoch 008 with loss 2.2273E-03
> Save model at epoch 009 with loss 2.2099E-03
> Save model at epoch 010 with loss 2.1969E-03
Epoch: 011 | Train Loss: 2.1880E-03 | Drift GN: 1.5528E-03 | Actu. GN: 1.6098E-03 | Time: 465ms
> Save model at epoch 011 with loss 2.1880E-03
> Save model at epoch 012 with loss 2.1810E-03
> Save model at epoch 013 with loss 2.1768E-03
> Save model at epoch 014 with loss 2.1759E-03
> Save model at epoch 015 with loss 2.1709E-03
Epoch: 016 | Train Loss: 2.1723E-03 | Drift GN: 1.6917E-03 | Actu. GN: 1.7229E-03 | Time: 454ms
> Save model at epoch 017 with loss 2.1681E-03
> Save model at epoch 018 with loss 2.1673E-03
> Save model at epoch 019 with loss 2.1634E-03
Epoch: 021 | Train Loss: 2.1619E-03 | Drift GN: 1.3893E-03 | Actu. GN: 1.8279E-03 | Time: 455ms
> Save model at epoch 021 with loss 2.1619E-03
> Save model at epoch 024 with loss 2.1592E-03
> Save model at epoch 025 with loss 2.1531E-03
Epoch: 026 | Train Loss: 2.1588E-03 | Drift GN: 1.3621E-03 | Actu. GN: 1.9331E-03 | Time: 455ms
> Save model at epoch 029 with loss 2.1520E-03
Epoch: 031 | Train Loss: 2.1564E-03 | Drift GN: 1.1120E-03 | Actu. GN: 2.4950E-03 | Time: 462ms
Epoch: 036 | Train Loss: 2.1605E-03 | Drift GN: 1.3568E-03 | Actu. GN: 2.3486E-03 | Time: 458ms
Epoch: 041 | Train Loss: 2.1642E-03 | Drift GN: 1.3411E-03 | Actu. GN: 2.9329E-03 | Time: 452ms
Epoch: 046 | Train Loss: 2.1621E-03 | Drift GN: 1.2163E-03 | Actu. GN: 2.8264E-03 | Time: 460ms
Epoch: 051 | Train Loss: 2.1658E-03 | Drift GN: 1.3689E-03 | Actu. GN: 2.5039E-03 | Time: 455ms
Epoch: 056 | Train Loss: 2.1707E-03 | Drift GN: 1.2648E-03 | Actu. GN: 3.3483E-03 | Time: 448ms
Epoch: 061 | Train Loss: 2.1747E-03 | Drift GN: 1.2727E-03 | Actu. GN: 4.1405E-03 | Time: 447ms
Epoch: 066 | Train Loss: 2.1813E-03 | Drift GN: 1.4997E-03 | Actu. GN: 3.8409E-03 | Time: 458ms
Epoch: 071 | Train Loss: 2.1693E-03 | Drift GN: 1.2634E-03 | Actu. GN: 3.4763E-03 | Time: 447ms
Epoch: 076 | Train Loss: 2.1664E-03 | Drift GN: 1.2066E-03 | Actu. GN: 3.7185E-03 | Time: 456ms
Epoch: 081 | Train Loss: 2.1525E-03 | Drift GN: 1.0740E-03 | Actu. GN: 2.4650E-03 | Time: 453ms
Epoch: 086 | Train Loss: 2.1569E-03 | Drift GN: 1.1559E-03 | Actu. GN: 2.6088E-03 | Time: 456ms
> Save model at epoch 089 with loss 2.1505E-03
> Save model at epoch 090 with loss 2.1481E-03
Epoch: 091 | Train Loss: 2.1477E-03 | Drift GN: 1.0290E-03 | Actu. GN: 1.8508E-03 | Time: 450ms
> Save model at epoch 091 with loss 2.1477E-03
> Save model at epoch 092 with loss 2.1469E-03
> Save model at epoch 094 with loss 2.1466E-03
> Save model at epoch 095 with loss 2.1466E-03
Epoch: 096 | Train Loss: 2.1449E-03 | Drift GN: 9.1405E-04 | Actu. GN: 1.5859E-03 | Time: 471ms
> Save model at epoch 096 with loss 2.1449E-03
> Save model at epoch 098 with loss 2.1449E-03
> Save model at epoch 099 with loss 2.1441E-03
> Save model at epoch 100 with loss 2.1441E-03
Total time: 46s52ms
==> Plot drift errors (after training)
> (x1, x2): mean = 0.0560, max = 0.1998
> (x1, x3): mean = 0.0466, max = 0.1833
> (x2, x3): mean = 0.0627, max = 0.1903
==> Plot actuation errors (after training)
> (x1, x2): mean = 0.0457, max = 0.0457
> (x1, x3): mean = 0.0457, max = 0.0457
> (x2, x3): mean = 0.0457, max = 0.0457
==> Building Lyapunov neural network ...
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
LyapunovNetwork                          [1, 1]                    --
├─Sequential: 1-1                        [1, 64]                   --
│    └─LinearLayer: 2-1                  [1, 64]                   192
│    └─LinearLayer: 2-2                  [1, 64]                   4,096
│    └─LinearLayer: 2-3                  [1, 64]                   4,096
==========================================================================================
Total params: 8,384
Trainable params: 8,384
Non-trainable params: 0
Total mult-adds (M): 0.01
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 0.03
Estimated Total Size (MB): 0.04
==========================================================================================
==> Building controller neural network ...
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
FullyConnectedNetwork                    [1, 1]                    --
├─Sequential: 1-1                        [1, 1]                    --
│    └─LinearLayer: 2-1                  [1, 16]                   48
│    └─LinearLayer: 2-2                  [1, 16]                   256
│    └─LinearLayer: 2-3                  [1, 1]                    16
==========================================================================================
Total params: 320
Trainable params: 320
Non-trainable params: 0
Total mult-adds (M): 0.00
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 0.00
Estimated Total Size (MB): 0.00
==========================================================================================
==> Amount of training data:  27000
==> Creating training data ...
==> Start training ...
Epoch: 001 | Train Loss: 1.5542E-02 | Lya GN: 8.9318E-01 | Ctrl GN: 2.1743E-01 | Time: 157ms
Epoch: 001 | Test Loss: 1.1852E-02 | Time: 60ms
> Save at epoch 001 | Test loss 1.1852E-02
Epoch: 002 | Test Loss: 6.7417E-06 | Time: 59ms
> Save at epoch 002 | Test loss 6.7417E-06
Epoch: 003 | Test Loss: 0.0000E+00 | Time: 91ms
> Save at epoch 003 | Test loss 0.0000E+00
Epoch: 004 | Test Loss: 1.0823E-06 | Time: 59ms
Epoch: 005 | Test Loss: 2.5614E-06 | Time: 59ms
Epoch: 006 | Train Loss: 1.2750E-04 | Lya GN: 1.2691E-02 | Ctrl GN: 3.6651E-03 | Time: 130ms
Epoch: 006 | Test Loss: 3.1127E-06 | Time: 87ms
Epoch: 007 | Test Loss: 2.6458E-06 | Time: 59ms
Epoch: 008 | Test Loss: 5.0339E-07 | Time: 59ms
Epoch: 009 | Test Loss: 8.4651E-07 | Time: 87ms
Epoch: 010 | Test Loss: 1.4977E-06 | Time: 59ms
Total time: 2s25ms
==> Visualizing training and test losses ...
==> Saving the training results ...
==> Computing the Lyapunov function and stability condition ...
==> Checking the forward invariant set ...
==> Checking the Lyapunov function and stability condition ...
> Success:  True
==> Saving the forward invariant set ...
> Forward invariant set Lyapunov value:  0.20663582
> Forward invariant set percentage:  0.211328
==> Visualizing the Lyapunov function and stability condition ...
==> Done!
